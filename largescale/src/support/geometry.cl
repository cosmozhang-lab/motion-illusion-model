inline int coor2idx2d(int rows, int cols, int ir, int ic) {
  return ir * cols + ic;
}